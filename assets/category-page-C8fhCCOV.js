import{d as g,s as P,u as B,o as l,c as i,w as V,v as q,a as c,b as f,i as F,e as T,f as b,g as I,h as x,t as y,n as R,F as C,r as N,j as k,k as D,l as E,m as w,p as M,q as U,x as j,y as A,_ as z}from"./index-BSjoGW-V.js";import{u as v,l as $}from"./lodash-DqkDTI2-.js";const H={class:"flex justify-center"},L=g({__name:"search-items",setup(p){const e=v(),{searchValue:o}=P(e),{searchItems:a}=e,m=B();function s(){a(),m.replace({name:"categoryPage"})}return(t,r)=>(l(),i("div",H,[V(f("input",{"onUpdate:modelValue":r[0]||(r[0]=d=>F(o)?o.value=d:null),type:"search",name:"search",autocomplete:"off",placeholder:"Поиск по артикулу или наименованию",class:"bg-white border border-slate-300 rounded-md p-2 w-full text-xs shadow-md text-center focus:outline-none focus:shadow-lg sm:w-3/5 sm:text-base",onInput:s},null,544),[[q,c(o)]])]))}}),Q=["name","value","checked","disabled"],G=g({__name:"filter-button",props:{label:{},fieldsetTitle:{}},setup(p){const{label:e,fieldsetTitle:o}=p,a=v(),m=T(),s=b(()=>!a.visibleProducts.find(r=>r[o]===e)),t=b(()=>m.query[o]==e);return I(()=>{if(t.value){const r=[];r.push(e),a.filters[o]=r,a.filterItems()}}),(r,d)=>(l(),i("label",{class:R(["p-1.5 leading-none rounded-md",{"text-slate-300":s.value,"cursor-pointer has-[:checked]:bg-sky-600 has-[:checked]:text-gray-50":!s.value}])},[f("input",{type:"checkbox",name:String(r.label),value:String(r.label),class:"appearance-none absolute",checked:t.value,disabled:s.value},null,8,Q),x(" "+y(r.label),1)],2))}}),J={class:"font-semibold"},K=g({__name:"filter-fieldset",props:{fieldsetTitle:{}},setup(p){const{fieldsetTitle:e}=p,o=v(),a=T(),m=B(),s=b(()=>o.products.reduce((n,_)=>{const u=_[e];return!n.includes(u)&&!$.isUndefined(u)&&n.push(u),n},[]));let t;s.value.every(n=>$.isNumber(n))?t=s.value.sort((n,_)=>Number(n)-Number(_)):t=s.value.sort(),o.filters[e]=t;function r(n){const _=h=>{let S=Number(h.value);return String(S)==="NaN"&&(S=h.value),S};let u=[];n.currentTarget&&(u=Array.from(n.currentTarget.elements).filter(h=>h.checked).map(h=>_(h))),d(u),u.length||(u=t),o.filters[e]=u}function d(n){!!document.querySelectorAll("input:checked").length?m.replace({name:"categoryPage",query:{...a.query,[e]:n}}):m.replace({name:"categoryPage"})}return(n,_)=>(l(),i("fieldset",{class:"flex gap-1 flex-wrap place-content-start",onChange:r},[f("legend",J,y(n.fieldsetTitle),1),(l(!0),i(C,null,N(c(t),u=>(l(),k(c(G),{key:u,label:u,"fieldset-title":n.fieldsetTitle},null,8,["label","fieldset-title"]))),128))],32))}}),O={class:"w-full sm:w-2/6"},W=f("h3",{class:"text-xl font-semibold"},"Фильтры:",-1),X=g({__name:"filter-form",setup(p){const e=v(),{fieldsetTitles:o}=P(e),{filterItems:a}=e;return(m,s)=>(l(),i("aside",O,[W,f("form",{class:"pl-2 pt-2 flex flex-col gap-1.5",onChange:s[0]||(s[0]=D((...t)=>c(a)&&c(a)(...t),["prevent"]))},[(l(!0),i(C,null,N(c(o),t=>(l(),k(c(K),{key:t,"fieldset-title":t},null,8,["fieldset-title"]))),128))],32)]))}}),Y={class:"py-1.5"},Z=g({__name:"product-item",props:{orderNum:{},name:{}},setup(p){return(e,o)=>{const a=E("router-link");return l(),i("li",Y,[w(a,{to:{name:"productPage",params:{product:String(e.orderNum)}},target:"_blank",class:"h-full"},{default:M(()=>[x(y(e.orderNum)+" - "+y(e.name),1)]),_:1},8,["to"])])}}}),ee={key:1},te={class:"text-center mt-5 text-2xl font-bold"},se={class:"flex flex-col gap-5 mt-3 sm:flex-row"},oe={class:"w-full sm:w-4/6"},re=f("h3",{class:"text-xl text-center font-semibold sm:text-left"},"Возможные варианты:",-1),le={key:0,class:"text-center mt-3 sm:text-left"},ne=f("br",null,null,-1),ae={key:1},ie=g({__name:"category-page",setup(p){const e=T(),o=b(()=>e.params.category),a=U(),m=b(()=>{var r;const t=(r=a.cards.find(d=>d.link===o.value))==null?void 0:r.title;return typeof t=="string"&&(document.title=t),t}),s=v();return j(()=>{s.fetchProducts(o.value)}),A(()=>s.searchValue=""),(t,r)=>(l(),i("main",null,[c(s).loading?(l(),k(c(z),{key:0})):(l(),i("div",ee,[w(c(L)),f("h1",te,y(m.value),1),f("div",se,[w(c(X)),f("div",oe,[re,c(s).visibleProducts.length?(l(),i("ul",ae,[(l(!0),i(C,null,N(c(s).visibleProducts,d=>(l(),k(Z,{key:d._id,"order-num":d.Артикул,name:d.Наименование},null,8,["order-num","name"]))),128))])):(l(),i("p",le,[x(" Изделий с выбранными характеристиками нет "),ne,x(" Попробуйте изменить критерии поиска ")]))])])]))]))}});export{ie as default};
